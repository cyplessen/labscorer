% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_sum_scores.R
\name{calculate_sum_scores}
\alias{calculate_sum_scores}
\title{Calculate sum and mean scores for a psychometric scale}
\usage{
calculate_sum_scores(
  df,
  scale,
  item_indices,
  na_rm = FALSE,
  inverse_items = NULL,
  min_score = 1,
  max_score = NULL,
  recode_items = NULL,
  subscales = NULL,
  timepoint_prefix = getOption("labscorer.timepoint_prefix", NULL),
  calc_sum = TRUE,
  calc_mean = TRUE,
  subscale_suffix = "_sub_sum"
)
}
\arguments{
\item{df}{A data frame with item-level columns.}

\item{scale}{Character; scale prefix in column names (e.g. \code{"phq"}).}

\item{item_indices}{Vector of item numbers (numeric or character).}

\item{na_rm}{Logical; ignore \code{NA}s in \code{rowSums}/\code{rowMeans}? Default \code{FALSE}.
\strong{Note:} when \code{TRUE}, rows where \emph{all} items are \code{NA} return \code{0} for sums
and \code{NaN} for means. Consider using a minimum-response threshold in your
analysis instead.}

\item{inverse_items}{Optional vector of item indices to invert.}

\item{min_score}{Minimum possible item score (default \code{1}).}

\item{max_score}{Maximum possible item score; \strong{required} when
\code{inverse_items} is supplied.}

\item{recode_items}{Optional named list of recoding functions keyed by item
index as character (e.g. \code{list("10" = my_fn)}). Recoded items are excluded
from inversion.}

\item{subscales}{Optional named list of subscale definitions; each element is
a vector of item indices.}

\item{timepoint_prefix}{Character prefix for timepoints (e.g. \code{"t"}) or
\code{NULL} for cross-sectional data. Defaults to
\code{getOption("labscorer.timepoint_prefix", NULL)}.}

\item{calc_sum}{Logical; compute total sum? Default \code{TRUE}.}

\item{calc_mean}{Logical; compute total mean? Default \code{TRUE}.}

\item{subscale_suffix}{Character suffix for subscale sum columns (default
\code{"_sub_sum"}).}
}
\value{
The input data frame with additional score columns appended.
}
\description{
Computes total sum scores, mean scores, and optional subscale scores for a
single questionnaire. Handles item inversion, custom recoding, and automatic
timepoint detection.
}
\section{Column naming convention}{

Item columns should be named \verb{<prefix><scale>_<item>} where \verb{<prefix>} is
either empty (no timepoints) or \verb{<tp>_} (e.g. \code{t1_}). Created score columns
follow the same convention:
\itemize{
\item \verb{<prefix><scale>_sum} — total sum score
\item \verb{<prefix><scale>_mean} — total mean score
\item \verb{<prefix><scale>_<subscale><subscale_suffix>} — subscale sum
\item \verb{<prefix><scale>_<subscale>_mean} — subscale mean
}
}

\section{Processing order}{

For each timepoint: (1) recoding → (2) inversion (excluding already-recoded
items) → (3) total sum/mean → (4) subscale sum/mean.
}

\examples{
options(labscorer.timepoint_prefix = "t")
df <- data.frame(t1_phq_1 = c(0, 1, 2), t1_phq_2 = c(3, 2, 1))
calculate_sum_scores(df, scale = "phq", item_indices = 1:2,
                     min_score = 0, max_score = 3)
}
